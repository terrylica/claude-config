# mql5-crossover

MetaTrader 5 indicator data export and Python validation framework for AI-driven replication workflows.

## Status

**Version**: 1.0.0
**Reorganization**: Complete (2025-10-13)
**Validation**: 0.999902 RSI correlation (MT5 vs Python)
**Headless Execution**: Python API approach (v3.0.0 COMPLETE)

## Quick Start

1. **Manual data export** (first time setup):
   ```bash
   # Open MT5, drag ExportAligned script onto chart
   # CSV output: ~/Library/Application Support/CrossOver/.../MQL5/Files/
   ```

2. **Headless execution** (requires CrossOver + Wine Python):
   ```bash
   # v3.0.0: True headless via Python API
   cxstart --bottle "MetaTrader 5" -- cmd /c "python C:\users\crossover\export_aligned.py --symbol EURUSD --period M1 --bars 5000"

   # v2.0.0: Conditionally working (requires GUI init per symbol)
   ./scripts/mq5run --symbol EURUSD --period PERIOD_M1
   ```

3. **Validate output**:
   ```bash
   python python/validate_export.py exports/Export_EURUSD_PERIOD_M1.csv
   ```

## Directory Structure

```
mql5-crossover/
├── mql5/              # MQL5 source code
│   ├── Scripts/       # MT5 scripts (ExportAligned.mq5)
│   ├── Include/       # Shared headers and modules
│   └── Samples/       # Example scripts
├── python/            # Python validation tools
│   └── validate_export.py
├── scripts/           # Automation scripts
│   └── mq5run         # Headless MT5 execution wrapper (v2.0.0)
├── docs/              # Documentation
│   ├── guides/        # User guides (QUICKSTART, AI_AGENT_WORKFLOW, CROSSOVER_MQ5)
│   ├── plans/         # Implementation plans (HEADLESS_EXECUTION_PLAN v3.0.0)
│   ├── reports/       # Validation reports (SUCCESS_REPORT, VALIDATION_STATUS)
│   └── archive/       # Historical documentation
├── config/            # Configuration files
│   └── startup.ini    # MT5 startup config template
├── exports/           # CSV export outputs
└── logs/              # Execution logs
```

## Core Features

- **MQL5 Data Export**: OHLC + indicators to CSV with timestamp alignment
- **Headless Execution**: Wine Python + MetaTrader5 API for true headless capability (v3.0.0)
- **Python Validation**: Automated integrity checks and indicator correlation
- **Modular Indicators**: Plugin architecture for adding technical indicators (RSI implemented)
- **AI Workflow Integration**: Designed for AI agent development and validation cycles

## Documentation

- **[Quick Start Guide](docs/guides/QUICKSTART.md)** - Get up and running in 5 minutes
- **[AI Agent Workflow](docs/guides/AI_AGENT_WORKFLOW.md)** - Complete development workflow
- **[CrossOver Essentials](docs/guides/CROSSOVER_MQ5.md)** - MT5/Wine environment setup
- **[Implementation Plan](docs/plans/HEADLESS_EXECUTION_PLAN.md)** - v3.0.0 Python API approach (COMPLETE)
- **[Validation Status](docs/reports/VALIDATION_STATUS.md)** - Current SLO metrics and test results

## Requirements

- macOS with CrossOver 24+ (or Wine 10+)
- MetaTrader 5 Build 4865+
- Python 3.12+ (both native macOS and Wine Python for v3.0.0)
- MT5 account (demo or live)

## Usage Examples

### Compile MQL5 Script
```bash
mq5c mql5/Scripts/ExportAligned.mq5
```

### Export Data (v3.0.0 - True Headless)
```bash
# Works for ANY symbol/timeframe without GUI initialization
cxstart --bottle "MetaTrader 5" -- cmd /c "python C:\users\crossover\export_aligned.py --symbol XAUUSD --period H1 --bars 5000"
```

### Export Data (v2.0.0 - Requires GUI Init)
```bash
# Requires symbol/timeframe opened in GUI once
./scripts/mq5run --symbol EURUSD --period PERIOD_M1 --timeout 120
```

### Validate Export
```bash
python python/validate_export.py exports/Export_EURUSD_PERIOD_M1.csv

# Expected output:
# ✓ All integrity checks passed
# ✓ RSI validation PASSED - Python implementation matches MT5
# Correlation: 0.999902
```

### Add New Indicator
1. Create module: `mql5/Include/modules/MyIndicatorModule.mqh`
2. Update script: `mql5/Scripts/ExportAligned.mq5`
3. Recompile: `mq5c mql5/Scripts/ExportAligned.mq5`
4. Export data and validate

## Service Level Objectives

- **Availability**: 100% file accessibility after reorganization ✓
- **Correctness**: 100% reference resolution, correlation ≥ 0.999 ✓
- **Observability**: 100% operations logged via git commits ✓
- **Maintainability**: 100% structure compliance with language conventions ✓

## Known Limitations

### v3.0.0 (Python API)
- ✅ **RESOLVED**: True headless execution for any symbol/timeframe
- Requires Wine Python 3.12+ with MetaTrader5 package and NumPy 1.26.4 (not 2.x)
- Cold start validated: XAUUSD M1/H1 work without prior GUI initialization

### v2.0.0 (startup.ini)
- ⚠️ **Conditional**: Headless execution requires prior GUI initialization per symbol/timeframe
- Each new symbol must be manually opened in MT5 GUI once before headless execution works
- Root cause: MT5 `[StartUp]` section requires existing chart context

## Project History

- **2025-10-13**: Repository reorganization v1.0.0 complete
- **2025-10-13**: Headless execution v3.0.0 (Python API) - TRUE HEADLESS ACHIEVED
- **2025-10-13**: Headless execution v2.0.0 (startup.ini) - conditionally working
- **2025-10-13**: Manual execution validated (0.999902 RSI correlation)
- **2022-2025**: Community research findings archived in `docs/archive/historical.txt`

## Contributing

See `docs/guides/AI_AGENT_WORKFLOW.md` for development workflow and indicator addition guide.

## License

Internal research project - no public license specified.
