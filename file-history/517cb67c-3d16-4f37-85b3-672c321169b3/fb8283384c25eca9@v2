#!/usr/bin/env python3
"""
Verify Tokyo lunch break boundaries using exchange_calendars directly.
"""

import exchange_calendars as xcals
import pandas as pd

# Load Tokyo Stock Exchange calendar
xtks = xcals.get_calendar("XTKS")

# Test timestamps around lunch break on Aug 5, 2024 (Monday)
test_times_jst = [
    "2024-08-05 11:29:00",  # 1 minute before lunch
    "2024-08-05 11:30:00",  # Lunch starts
    "2024-08-05 11:31:00",  # During lunch
    "2024-08-05 12:29:00",  # End of lunch
    "2024-08-05 12:30:00",  # Trading resumes
    "2024-08-05 12:31:00",  # 1 minute after lunch
]

print("Tokyo Stock Exchange (XTKS) - Lunch Break Boundaries")
print("=" * 60)

for time_str in test_times_jst:
    ts = pd.Timestamp(time_str, tz="Asia/Tokyo")
    is_open = xtks.is_open_on_minute(ts)
    status = "OPEN ✓" if is_open else "CLOSED ✗"
    print(f"{time_str} JST: {status}")

print("\n" + "=" * 60)
print("Interpretation:")
print("  - Lunch STARTS at 11:30 (closed)")
print("  - Lunch ENDS at 12:30 (trading resumes)")
print("  - So lunch period is [11:30, 12:30) exclusive of 12:30")
