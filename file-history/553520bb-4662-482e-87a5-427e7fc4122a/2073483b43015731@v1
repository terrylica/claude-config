#!/bin/bash
export PATH="/opt/homebrew/bin:/usr/local/bin:$PATH"
LOG_DIR="$HOME/scripts/homebrew-autoupdate/logs"
TIMESTAMP=$(date +"%Y-%m-%d_%H-%M-%S")
mkdir -p "$LOG_DIR"
echo "[$TIMESTAMP] Starting Homebrew auto-update" | tee -a "$LOG_DIR/output.txt"
brew update 2>&1 | tee -a "$LOG_DIR/output.txt" || { echo "[$TIMESTAMP] Error: brew update failed" | tee -a "$LOG_DIR/error.txt"; exit 1; }
brew upgrade 2>&1 | tee -a "$LOG_DIR/output.txt" || { echo "[$TIMESTAMP] Error: brew upgrade failed" | tee -a "$LOG_DIR/error.txt"; exit 1; }
brew cleanup 2>&1 | tee -a "$LOG_DIR/output.txt" || { echo "[$TIMESTAMP] Error: brew cleanup failed" | tee -a "$LOG_DIR/error.txt"; exit 1; }
echo "[$TIMESTAMP] Homebrew auto-update completed successfully" | tee -a "$LOG_DIR/output.txt"
