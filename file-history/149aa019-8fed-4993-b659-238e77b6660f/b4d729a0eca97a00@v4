//+------------------------------------------------------------------+
//|                                           CandlePatterns.mqh     |
//|                                                        Terry Li |
//|                  Candlestick pattern detection (inside bar, etc) |
//+------------------------------------------------------------------+

//+------------------------------------------------------------------+
//| Check if current bar is an inside bar                            |
//| Inside bar: High <= prev high AND Low >= prev low                |
//+------------------------------------------------------------------+
bool CheckInsideBar(const double &high[], const double &low[], int bar)
{
   // Need at least one previous bar
   if(bar >= ArraySize(high) - 1)
      return false;

   // Inside bar condition:
   // Current bar's range is completely within previous bar's range
   if(high[bar] <= high[bar+1] && low[bar] >= low[bar+1])
      return true;

   return false;
}

//+------------------------------------------------------------------+
//| Set inside bar signal as purple colored bar                      |
//| Requires: Global buffers and input parameters from parent        |
//| Priority system: Only colors bar if not already colored          |
//+------------------------------------------------------------------+
void SetInsideBarSignal(int bar, bool isBullish, const double &high[], const double &low[])
{
   // Only set purple if bar is not already colored by a higher priority pattern
   // Priority: Contractions > Inside bars
   if(InpShowColorBars && BufferColorIndex[bar] == COLOR_NONE)
      BufferColorIndex[bar] = CLR_INSIDE_BAR;
}
//+------------------------------------------------------------------+
