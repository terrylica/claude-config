"""
okx-price-provider: Universal OKX price data provider with streaming download and Parquet caching.

This library provides real spot prices for OKX trading pairs using aggregate trade data from OKX CDN.
Key features:
- Zero CSV storage (streaming pipeline)
- Parquet-backed cache with zstd compression (2-4 GB for 2 years)
- VWAP computation at configurable intervals (default: 8H for funding arbitrage)
- Fast price lookups with forward-fill for missing data
- Production-ready: typed, tested, documented

Example usage:
    >>> from okx_price_provider import OKXPriceProvider, download_and_process_month
    >>>
    >>> # Download and process data for Oct 2023
    >>> download_and_process_month("allspot", "2023-10", cache_dir="data/okx_price_cache")
    >>>
    >>> # Load price provider
    >>> provider = OKXPriceProvider(cache_dir="data/okx_price_cache")
    >>>
    >>> # Get price for BTC at specific timestamp
    >>> price = provider.get_price("BTC", pd.Timestamp("2023-10-01 08:00:00", tz="UTC"))
    >>> print(f"BTC price: ${price:,.2f}")
"""

__version__ = "0.1.0"

from .downloader import (
    download_and_stream_okx_data,
    download_okx_month,
    list_okx_files,
)

from .parser import (
    StreamingVWAPAggregator,
    parse_aggtrades_chunk,
)

from .cache import (
    ParquetVWAPCache,
)

from .provider import (
    OKXPriceProvider,
)

from .utils import (
    normalize_symbol,
    validate_date_range,
    format_month,
)

__all__ = [
    # Downloader
    "download_and_stream_okx_data",
    "download_okx_month",
    "list_okx_files",
    # Parser
    "StreamingVWAPAggregator",
    "parse_aggtrades_chunk",
    # Cache
    "ParquetVWAPCache",
    # Provider
    "OKXPriceProvider",
    # Utils
    "normalize_symbol",
    "validate_date_range",
    "format_month",
]
