format:
  pdf:
    documentclass: article
    geometry:
      - top=1in
      - bottom=1.15in
      - left=0.9in
      - right=0.9in
      - footskip=0.5in
    fontsize: 10pt
    mainfont: "DejaVu Sans"
    sansfont: "DejaVu Sans"
    monofont: "DejaVu Sans Mono"
    CJKmainfont: "Noto Sans CJK SC"
    keep-tex: false
    pdf-engine: xelatex
    include-in-header:
      - text: |
          \usepackage{xeCJK}
          \usepackage{fontspec}
          \usepackage{unicode-math}
          \setmathfont{STIXMath-Regular.otf}
          \usepackage{tcolorbox}
          \tcbuselibrary{most}
          \usepackage{needspace}

          % Prevent widows, orphans, and heading orphans
          \clubpenalty=10000
          \widowpenalty=10000
          \displaywidowpenalty=10000

          % Prevent section headings at page bottom
          \usepackage{etoolbox}
          \preto\subsection{\needspace{5\baselineskip}}
          \preto\subsubsection{\needspace{4\baselineskip}}

          % Custom equation box styles (monochrome)
          \newtcolorbox{equationbox}{
            colback=black!3!white,
            colframe=black!70!white,
            fonttitle=\bfseries,
            title=计算公式,
            arc=3pt,
            boxrule=1pt,
            left=6pt,
            right=6pt,
            top=6pt,
            bottom=6pt
          }

          \newtcolorbox{formulabox}[1][]{
            colback=black!5!white,
            colframe=black!60!white,
            fonttitle=\bfseries,
            title=#1,
            arc=2pt,
            boxrule=0.8pt,
            left=5pt,
            right=5pt,
            top=5pt,
            bottom=5pt
          }

          \usepackage{booktabs}
          \usepackage{longtable}
          \usepackage{array}
          \usepackage{multirow}
          \usepackage{float}
          \usepackage{ulem}
          \usepackage{xcolor}
          \usepackage{soul}
          \usepackage{tabularx}
          \usepackage{ltxtable}
          \usepackage{lastpage}
          \usepackage{fancyhdr}

          % Better table formatting for landscape
          \setlength{\tabcolsep}{8pt}
          \renewcommand{\arraystretch}{1.2}

          % Left align all tables by default
          \usepackage{etoolbox}
          % Remove any centering for tables - they will be left aligned by default
          \normalem
          \setCJKmainfont{Noto Sans CJK SC}
          \setCJKsansfont{Noto Sans CJK SC}
          \setCJKmonofont{Noto Sans CJK SC}

          % Define yellow highlighting for inline code
          \definecolor{codehighlight}{RGB}{255,255,153}
          \let\oldtexttt\texttt
          \renewcommand{\texttt}[1]{\colorbox{codehighlight}{\oldtexttt{#1}}}

          % Define smaller font environment for appendix
          \newenvironment{appendixsize}{\footnotesize}{\normalsize}

          % Define CSS class for smaller text
          \AtBeginEnvironment{CSLReferences}{\footnotesize}
          \makeatletter
          \@ifundefined{Shaded}{}{\renewenvironment{Shaded}{\begin{tcolorbox}[breakable, boxrule=0pt, interior hidden, sharp corners, enhanced]}{\end{tcolorbox}}}
          \makeatother

          % Page numbering format: "第 X 页 / 共 Y 页"
          \pagestyle{fancy}
          \fancyhf{}
          \fancyfoot[C]{第 \thepage\ 页 / 共 \pageref{LastPage} 页}
          \renewcommand{\headrulewidth}{0pt}
          \renewcommand{\footrulewidth}{0pt}

          % Use left-aligned (ragged right) text instead of justified
          \raggedright