#!/usr/bin/env python3
"""Aggregate SWAP tick data to 1-min bars"""
import sys
from pathlib import Path
sys.path.insert(0, str(Path(__file__).parent))
from aggregate_month import aggregate_month_to_1min

year, month = 2025, 9
tick_file = Path("data/raw_ticks_swap/2025/09.parquet")
output_file = Path("data/1min_bars_swap/2025/09.parquet")

output_file.parent.mkdir(parents=True, exist_ok=True)

print(f"Aggregating {tick_file} → {output_file}")
aggregate_month_to_1min(tick_file, output_file)
print(f"✓ Saved to {output_file}")
