openapi: 3.1.0
info:
  title: Atuin Shell History Sync Specification
  description: Encrypted cloud-synced shell history with Atuin integration
  version: 1.0.0

components:
  schemas:
    AtuinSetup:
      type: object
      description: Atuin installation and initialization
      properties:
        installation:
          type: object
          properties:
            command:
              type: string
              example: "brew install atuin"
            version:
              type: string
              example: "18.8.0"
        initialization:
          type: object
          properties:
            shell_integration:
              type: string
              example: "eval \"$(atuin init zsh)\""
            location:
              type: string
              example: "~/.zshrc"
        import:
          type: object
          properties:
            command:
              type: string
              example: "atuin import auto"
            description:
              type: string
              example: "Import existing shell history from zsh/bash"

    AtuinCloudSync:
      type: object
      description: Encrypted cloud backup configuration
      properties:
        server:
          type: string
          example: "https://api.atuin.sh"
          description: "Official Atuin sync server"
        encryption:
          type: object
          properties:
            method:
              type: string
              example: "End-to-end encryption"
            key_storage:
              type: string
              example: "~/.local/share/atuin/key"
            key_format:
              type: string
              example: "24-word mnemonic phrase"
        authentication:
          type: object
          properties:
            register:
              type: string
              example: "atuin register -u <username> -e <email>"
            login:
              type: string
              example: "atuin login -u <username>"
          required:
            - register
            - login

    AtuinConfiguration:
      type: object
      description: Atuin configuration file settings
      properties:
        config_path:
          type: string
          example: "~/.config/atuin/config.toml"
        auto_sync:
          type: boolean
          example: true
          description: "Enable automatic sync after commands"
        sync_frequency:
          type: string
          example: "5m"
          description: "Sync interval (5 minutes recommended)"
        sync_address:
          type: string
          example: "https://api.atuin.sh"
        database:
          type: string
          example: "~/.local/share/atuin/history.db"
          description: "SQLite database with encrypted history"

    AtuinCredentials:
      type: object
      description: Atuin credentials stored in Doppler
      properties:
        storage:
          type: object
          properties:
            service:
              type: string
              example: "Doppler CLI"
            project:
              type: string
              example: "claude-config"
            config:
              type: string
              example: "dev"
        secrets:
          type: object
          properties:
            ATUIN_USERNAME:
              type: string
              description: "Atuin account username"
            ATUIN_EMAIL:
              type: string
              description: "Atuin account email"
            ATUIN_KEY:
              type: string
              description: "24-word encryption key mnemonic"
            ATUIN_PASSWORD:
              type: string
              description: "Account password (optional, for automated setup)"

    AtuinWorkflow:
      type: object
      description: Common Atuin operations
      properties:
        verification:
          type: object
          properties:
            status:
              type: string
              example: "atuin status"
            sync:
              type: string
              example: "atuin sync"
        usage:
          type: object
          properties:
            search:
              type: string
              example: "Ctrl+R (interactive fuzzy search)"
            command_search:
              type: string
              example: "atuin search <query>"
        multi_machine:
          type: object
          properties:
            setup:
              type: array
              items:
                type: string
              example:
                - "brew install atuin"
                - "echo 'eval \"$(atuin init zsh)\"' >> ~/.zshrc"
                - "atuin login -u <username>"
                - "# Enter password and encryption key when prompted"

paths: {}
