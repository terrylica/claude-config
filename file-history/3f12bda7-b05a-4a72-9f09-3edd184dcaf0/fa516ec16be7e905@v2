openapi: 3.1.0
info:
  title: PyPI Publishing Methods Specification
  description: Complete configuration for PyPI package publishing workflows
  version: 1.0.0

components:
  schemas:
    DopplerTokenMethod:
      type: object
      description: Doppler-managed PyPI token (primary method)
      properties:
        status:
          type: string
          enum: ["primary_method"]
        storage:
          type: object
          properties:
            service:
              type: string
              example: "Doppler"
            project:
              type: string
              example: "claude-config"
            config:
              type: string
              example: "dev"
            secret_name:
              type: string
              example: "PYPI_TOKEN"
        authentication:
          type: object
          properties:
            token_identifier:
              type: string
              example: "cc934ce2-87dc-4995-812b-1149d7e977cf"
            token_name:
              type: string
              example: "publishing"
            regeneration_url:
              type: string
              example: "https://pypi.org/manage/account/token/"
        usage:
          type: object
          properties:
            command:
              type: string
              example: "doppler run --project claude-config --config dev -- uv publish --token \"$PYPI_TOKEN\""
            setup_command:
              type: string
              example: "doppler secrets set PYPI_TOKEN=\"pypi-...\" --project claude-config --config dev"

    LegacyTokenMethod:
      type: object
      description: .pypirc token storage (deprecated - tokens expire)
      properties:
        status:
          type: string
          enum: ["deprecated"]
        location:
          type: string
          example: "$HOME/.pypirc"
        migration:
          type: string
          example: "Use Doppler (claude-config/dev/PYPI_TOKEN) for persistent token management"

    TrustedPublishing:
      type: object
      description: OIDC-based trusted publishing (primary method)
      properties:
        status:
          type: string
          enum: ["primary_method"]
        year_designation:
          type: string
          example: "2025 Best Practice"
        security:
          type: string
          example: "OIDC-based authentication (no stored tokens)"
        automation:
          type: string
          example: "GitHub Actions with .github/workflows/publish.yml"
        environments:
          type: object
          properties:
            production:
              type: string
              example: "pypi"
            testing:
              type: string
              example: "testpypi"
        approval_process:
          type: string
          example: "Manual approval required for production releases"
        features:
          type: array
          items:
            type: string
          example:
            - "Digital attestations"
            - "Sigstore signatures"
            - "Zero-credential workflow"
        documentation:
          type: string
          example: "docs/PUBLISHING.md for complete setup guide"

paths: {}