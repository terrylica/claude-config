openapi: 3.1.0
info:
  title: PyPI Publishing Methods Specification
  description: Active PyPI package publishing via Doppler credential management
  version: 2.0.0

components:
  schemas:
    DopplerTokenMethod:
      type: object
      description: Doppler-managed PyPI token (ACTIVE METHOD - use this exclusively)
      properties:
        status:
          type: string
          enum: ["primary_method"]
        storage:
          type: object
          properties:
            service:
              type: string
              example: "Doppler"
            project:
              type: string
              example: "claude-config"
            config:
              type: string
              example: "dev"
            secret_name:
              type: string
              example: "PYPI_TOKEN"
        authentication:
          type: object
          properties:
            token_identifier:
              type: string
              example: "2b59ad01-34b4-4425-b7a0-9ab49046ea4e"
            token_name:
              type: string
              example: "terrylica-entire-account"
            scope:
              type: string
              example: "Entire account (all projects)"
            regeneration_url:
              type: string
              example: "https://pypi.org/manage/account/token/"
        usage:
          type: object
          properties:
            command:
              type: string
              example: "doppler run --project claude-config --config dev -- uv publish --token \"$PYPI_TOKEN\""
            setup_command:
              type: string
              example: "doppler secrets set PYPI_TOKEN=\"pypi-...\" --project claude-config --config dev"

    DeprecatedMethods:
      type: object
      description: Deprecated publishing methods - DO NOT USE
      properties:
        pypirc:
          type: object
          properties:
            status:
              type: string
              enum: ["deprecated"]
            reason:
              type: string
              example: "Tokens expire frequently, not version controlled"
            location:
              type: string
              example: "$HOME/.pypirc (DO NOT USE)"
            migration:
              type: string
              example: "Token already migrated to Doppler (claude-config/dev/PYPI_TOKEN)"
        trusted_publishing:
          type: object
          properties:
            status:
              type: string
              enum: ["future_consideration"]
            reason:
              type: string
              example: "OIDC-based GitHub Actions workflow - not yet implemented"
            documentation:
              type: string
              example: "https://docs.pypi.org/trusted-publishers/"

paths: {}