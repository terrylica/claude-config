import pytest
from playwright.sync_api import Page

@pytest.mark.clean_slate
def test_with_fresh_auth(page: Page, clean_slate_with_fresh_auth):
    """Test that clean slate fresh auth works."""
    # Navigate to form
    page.goto("https://www.insurance.manulife.ca/dda/welcomeInformation", wait_until="networkidle")
    
    # Verify we're on the form (not redirected to signin)
    assert "welcomeInformation" in page.url.lower(), f"Expected form page, got: {page.url}"
    assert page.url.startswith("https://www.insurance.manulife.ca"), "Not on Manulife website"
    
    print(f"\nâœ… Fresh auth test passed!")
    print(f"   URL: {page.url}")
    print(f"   Cookies: {len(page.context.cookies())}")
