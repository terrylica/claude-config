#!/bin/bash
# Helix with auto-format on open
# Formats file with prettier, then opens in Helix

if [ -z "$1" ]; then
    echo "Usage: hxf <file>"
    echo "Formats file with prettier, then opens in Helix"
    exit 1
fi

# Check if running in interactive terminal
if [ ! -t 0 ]; then
    echo "Error: hxf must be run from an interactive terminal (e.g., Kitty)"
    echo "This script cannot be run from Claude Code's bash execution context"
    exit 1
fi

# Check if file is markdown
if [[ "$1" == *.md ]]; then
    # Format with prettier first (in-place)
    prettier --write --parser markdown "$1" 2>/dev/null
fi

# Use exec to replace shell process with Helix (ensures proper TTY inheritance)
exec hx "$1"
