id: session-storage-adoption
version: 1.0.0
status: active
owner: workspace
created: 2025-10-13T00:00:00Z
updated: 2025-10-13T00:00:00Z

objective:
  summary: Adopt official Claude Code session storage layout
  decision: Use ~/.claude/projects as canonical session root
  sources:
    - path: /Users/terryli/.nvm/versions/node/v22.17.0/lib/node_modules/@anthropic-ai/claude-code/cli.js:3411
      note: Functions Az1/FM/DEQ compute ~/.claude/projects/<encoded>/<uuid>.jsonl
    - path: /Users/terryli/.nvm/versions/node/v22.17.0/lib/node_modules/@anthropic-ai/claude-code/sdk.mjs:7256
      note: getClaudeConfigHomeDir() uses CLAUDE_CONFIG_DIR or ~/.claude

scope:
  includes:
    - Documentation updates
    - References and links
  excludes:
    - Code overrides of session paths
    - Custom storage abstractions

error_policy:
  raise_on_error: true
  retries: none
  fallbacks: none
  defaults: none
  silent_handling: false

slo:
  availability:
    target: 0.99
    definition: Docs and references remain accessible and consistent
  correctness:
    target: 1.00
    definition: All docs consistently define ~/.claude/projects as canonical and match current CLI behavior
  observability:
    target: 0.95
    definition: Link-check and static verification detect broken or outdated references
  maintainability:
    target: 0.95
    definition: Single-source-of-truth standard, no divergent guidance or custom storage paths

tooling:
  preference: off-the-shelf
  tools:
    - name: claude-code
      usage: official CLI determines storage layout
    - name: gfm-link-checker
      usage: verify internal link integrity

tasks:
  - id: update-architecture
    status: pending
    action: Remove symlink mapping guidance; document ~/.claude/projects as canonical
  - id: prune-legacy-references
    status: pending
    action: Remove or constrain mentions of system/sessions to historical context only
  - id: relink-index
    status: pending
    action: Ensure index and related docs link to the standard and architecture
  - id: validate-links
    status: pending
    action: Run internal link audit with gfm-link-checker

nuance_tracking:
  policy: update-on-discovery
  procedure:
    - capture new evidence paths and versions
    - bump version minor on clarifications; patch on fixes
    - keep historical deviations in standards doc only

