---
# CNS (Conversation Notification System) Specification
# Purpose: Audio notification with context engineering support (clipboard currently disabled)

metadata:
  name: "CNS (Conversation Notification System)"
  purpose: "Audio notification with context engineering support (clipboard currently disabled)"
  status: "active"
  architecture: "simplified"

core_files:
  configuration:
    path: ".claude/automation/cns/config/cns_config.json"
    description: "notification and volume settings, clipboard disabled"
  
  main_script:
    path: ".claude/automation/cns/conversation_handler.sh"
    description: "206 lines, audio processing"
  
  entry_point:
    path: ".claude/automation/cns/cns_hook_entry.sh"
    description: "hook system integration"
  
  notification_hook:
    path: ".claude/automation/cns/cns_notification_hook.sh"
    description: "audio notification with configurable volume + folder name announcement"
  
  manual_utility:
    path: "~/.local/bin/cns-notify"
    description: "available globally via ~/.local/bin"
  
  debug_logs:
    path: "/tmp/claude_cns_debug.log"
    description: "structured logging"

critical_principles:
  asynchronous_hook_architecture:
    description: "All CNS hooks MUST use fire-and-forget pattern to prevent session delays"
    
    patterns:
      fire_and_forget: "{ actual_work } &"
      description: "spawn background and exit immediately"
    
    requirements:
      no_timeouts: "Remove timeout values from settings.json for true async hooks"
      testing: "Hook execution must be < 10ms (script exit time, not work completion)"
    
    anti_patterns:
      description: "Never wait for clipboard processing, audio playback, or file operations"
    
    enforcement:
      description: "Any hook causing session ending delays must be refactored to async pattern"